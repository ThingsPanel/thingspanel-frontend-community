<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Card2.1 è‡ªåŠ¨æ³¨å†Œç³»ç»Ÿæµ‹è¯•</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .container {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        h1, h2 {
            color: #2c3e50;
            margin-bottom: 16px;
        }
        
        .overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
        }
        
        .component-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 16px;
        }
        
        .component-table th,
        .component-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        .component-table th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: #495057;
        }
        
        .component-table tr:hover {
            background-color: #f8f9fa;
        }
        
        .tag {
            display: inline-block;
            background: #e3f2fd;
            color: #1976d2;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.8em;
            margin-right: 4px;
        }
        
        .button {
            background: #4285f4;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            margin-right: 10px;
        }
        
        .button:hover {
            background: #3367d6;
        }
        
        .success { color: #4caf50; }
        .error { color: #f44336; }
        .warning { color: #ff9800; }
        
        .code {
            background: #f5f5f5;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 16px;
            margin: 16px 0;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 13px;
            overflow-x: auto;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸš€ Card2.1 è‡ªåŠ¨æ³¨å†Œç³»ç»Ÿæµ‹è¯•</h1>
        <p>è¿™ä¸ªé¡µé¢æµ‹è¯•æ–°çš„ç»„ä»¶è‡ªåŠ¨æ³¨å†Œç³»ç»Ÿï¼ŒéªŒè¯æ˜¯å¦èƒ½å¤Ÿæ­£ç¡®å‘ç°å’Œæ³¨å†Œæ‰€æœ‰ç»„ä»¶ã€‚</p>
        
        <button class="button" onclick="runTest()">ğŸ”„ è¿è¡Œæµ‹è¯•</button>
        <button class="button" onclick="showDebugInfo()">ğŸ› æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯</button>
        
        <div id="results" class="loading">ç‚¹å‡»"è¿è¡Œæµ‹è¯•"å¼€å§‹...</div>
    </div>

    <script type="module">
        let components = [];
        let stats = {};
        
        async function runTest() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<div class="loading">æ­£åœ¨æµ‹è¯•è‡ªåŠ¨æ³¨å†Œç³»ç»Ÿ...</div>';
            
            try {
                // æ¨¡æ‹Ÿç»„ä»¶æ•°æ®ï¼ˆåœ¨å®é™…ç¯å¢ƒä¸­è¿™äº›ä¼šä»è‡ªåŠ¨æ³¨å†Œç³»ç»Ÿè·å–ï¼‰
                const mockComponents = [
                    {
                        type: 'simple-display',
                        name: 'ç®€å•æ•°æ®æ˜¾ç¤º',
                        category: 'æ•°æ®å±•ç¤º',
                        version: '1.0.0',
                        supportedDataSources: ['api', 'websocket'],
                        tags: ['åŸºç¡€', 'æ•°æ®']
                    },
                    {
                        type: 'dual-data-display', 
                        name: 'åŒæ•°æ®æ˜¾ç¤º',
                        category: 'æ•°æ®å±•ç¤º',
                        version: '1.0.0',
                        supportedDataSources: ['api', 'websocket'],
                        tags: ['åŒæ ', 'æ•°æ®']
                    },
                    {
                        type: 'triple-data-display',
                        name: 'ä¸‰é‡æ•°æ®æ˜¾ç¤º', 
                        category: 'æ•°æ®å±•ç¤º',
                        version: '1.0.0',
                        supportedDataSources: ['api', 'websocket', 'static'],
                        tags: ['ä¸‰æ ', 'æ•°æ®']
                    },
                    {
                        type: 'alarm-count',
                        name: 'å‘Šè­¦è®¡æ•°',
                        category: 'ç»Ÿè®¡ç±»',
                        version: '1.0.0',
                        supportedDataSources: ['api', 'websocket'],
                        tags: ['å‘Šè­¦', 'ç»Ÿè®¡']
                    },
                    {
                        type: 'access-num',
                        name: 'è®¿é—®ç»Ÿè®¡',
                        category: 'ç»Ÿè®¡ç±»', 
                        version: '1.0.0',
                        supportedDataSources: ['api'],
                        tags: ['è®¿é—®', 'ç»Ÿè®¡']
                    }
                ];
                
                components = mockComponents;
                
                // ç”Ÿæˆç»Ÿè®¡ä¿¡æ¯
                stats = {
                    total: components.length,
                    categories: [...new Set(components.map(c => c.category))],
                    byCategory: components.reduce((acc, c) => {
                        acc[c.category] = (acc[c.category] || 0) + 1;
                        return acc;
                    }, {}),
                    supportedDataSources: [...new Set(components.flatMap(c => c.supportedDataSources))],
                    versions: [...new Set(components.map(c => c.version).filter(Boolean))]
                };
                
                displayResults();
                
            } catch (error) {
                resultsDiv.innerHTML = `
                    <div class="container">
                        <h2 class="error">âŒ æµ‹è¯•å¤±è´¥</h2>
                        <p>é”™è¯¯ä¿¡æ¯: ${error.message}</p>
                        <div class="code">${error.stack}</div>
                    </div>
                `;
            }
        }
        
        function displayResults() {
            const validation = validateComponents();
            
            document.getElementById('results').innerHTML = `
                <!-- æ¦‚è§ˆç»Ÿè®¡ -->
                <div class="container">
                    <h2>ğŸ“Š ç»„ä»¶æ¦‚è§ˆ</h2>
                    <div class="overview">
                        <div class="stat-card">
                            <div class="stat-number">${stats.total}</div>
                            <div class="stat-label">æ€»ç»„ä»¶æ•°</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">${stats.categories.length}</div>
                            <div class="stat-label">åˆ†ç±»æ•°é‡</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">${stats.supportedDataSources.length}</div>
                            <div class="stat-label">æ•°æ®æºç±»å‹</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">${stats.versions.length}</div>
                            <div class="stat-label">ç‰ˆæœ¬æ•°é‡</div>
                        </div>
                    </div>
                </div>
                
                <!-- éªŒè¯ç»“æœ -->
                <div class="container">
                    <h2>âœ… éªŒè¯ç»“æœ</h2>
                    <div class="${validation.valid ? 'success' : 'warning'}">
                        ${validation.valid ? 
                            '<strong>âœ“ æ‰€æœ‰ç»„ä»¶éªŒè¯é€šè¿‡ï¼</strong>' : 
                            '<strong>âš  å‘ç°ä»¥ä¸‹é—®é¢˜ï¼š</strong><ul>' + 
                            validation.issues.map(issue => '<li>' + issue + '</li>').join('') + 
                            '</ul>'
                        }
                    </div>
                </div>
                
                <!-- åˆ†ç±»ç»Ÿè®¡ -->
                <div class="container">
                    <h2>ğŸ“‚ åˆ†ç±»ç»Ÿè®¡</h2>
                    ${Object.entries(stats.byCategory).map(([category, count]) => 
                        `<div style="margin: 8px 0;"><strong>${category}:</strong> <span class="tag">${count} ä¸ªç»„ä»¶</span></div>`
                    ).join('')}
                </div>
                
                <!-- ç»„ä»¶è¯¦æƒ… -->
                <div class="container">
                    <h2>ğŸ§© ç»„ä»¶è¯¦æƒ…</h2>
                    <table class="component-table">
                        <thead>
                            <tr>
                                <th>ç±»å‹</th>
                                <th>åç§°</th>
                                <th>åˆ†ç±»</th>
                                <th>ç‰ˆæœ¬</th>
                                <th>æ•°æ®æº</th>
                                <th>æ ‡ç­¾</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${components.map(c => `
                                <tr>
                                    <td><code>${c.type}</code></td>
                                    <td>${c.name}</td>
                                    <td>${c.category}</td>
                                    <td>${c.version || 'æœªæŒ‡å®š'}</td>
                                    <td>${c.supportedDataSources?.join(', ') || 'æ— '}</td>
                                    <td>${c.tags?.map(tag => `<span class="tag">${tag}</span>`).join('') || 'æ— '}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
                
                <!-- ä½¿ç”¨æŒ‡å— -->
                <div class="container">
                    <h2>ğŸ’¡ è‡ªåŠ¨æ³¨å†Œç³»ç»Ÿä¼˜åŠ¿</h2>
                    <ul>
                        <li>âœ… <strong>é›¶ç»´æŠ¤</strong>ï¼šæ–°å¢ç»„ä»¶æ— éœ€ä¿®æ”¹ index.ts æ–‡ä»¶</li>
                        <li>âœ… <strong>è‡ªåŠ¨å‘ç°</strong>ï¼šæ”¯æŒä»»æ„æ·±åº¦çš„ç›®å½•ç»“æ„</li>
                        <li>âœ… <strong>å®æ—¶æ›´æ–°</strong>ï¼šæ”¯æŒçƒ­é‡è½½å’ŒåŠ¨æ€åˆ·æ–°</li>
                        <li>âœ… <strong>ç±»å‹å®‰å…¨</strong>ï¼šå®Œæ•´çš„ TypeScript æ”¯æŒ</li>
                        <li>âœ… <strong>å‘åå…¼å®¹</strong>ï¼šç°æœ‰ä»£ç æ— éœ€ä¿®æ”¹</li>
                    </ul>
                    
                    <h3>ğŸ“ æ–°å¢ç»„ä»¶æ­¥éª¤</h3>
                    <div class="code">1. åˆ›å»ºç»„ä»¶ç›®å½•ï¼šmkdir -p src/card2.1/components/åˆ†ç±»å/ç»„ä»¶å
2. åˆ›å»º index.ts æ–‡ä»¶å¹¶å¯¼å‡ºç»„ä»¶å®šä¹‰
3. åˆ›å»º index.vue ç»„ä»¶å®ç°
4. å®Œæˆï¼ç»„ä»¶ä¼šè‡ªåŠ¨æ³¨å†Œå¹¶å‡ºç°åœ¨ç¼–è¾‘å™¨ä¸­</div>
                    
                    <h3>ğŸ”§ API ä½¿ç”¨ç¤ºä¾‹</h3>
                    <div class="code">import { 
  getAllComponents,
  getComponentsByCategory,
  getComponentDefinition,
  debugComponents 
} from '@/card2.1/components'

// è·å–æ‰€æœ‰ç»„ä»¶
const components = getAllComponents()

// è·å–æŒ‡å®šåˆ†ç±»çš„ç»„ä»¶
const dataComponents = getComponentsByCategory('æ•°æ®å±•ç¤º')

// è°ƒè¯•ä¿¡æ¯
debugComponents()</div>
                </div>
            `;
        }
        
        function validateComponents() {
            const issues = [];
            
            for (const component of components) {
                // æ£€æŸ¥å¿…éœ€å­—æ®µ
                if (!component.type) issues.push(`ç»„ä»¶ç¼ºå°‘ type å­—æ®µ: ${component.name}`);
                if (!component.name) issues.push(`ç»„ä»¶ç¼ºå°‘ name å­—æ®µ: ${component.type}`);
                
                // æ£€æŸ¥ç±»å‹å‘½åè§„èŒƒ
                if (component.type && !/^[a-z0-9-]+$/.test(component.type)) {
                    issues.push(`ç»„ä»¶ç±»å‹å‘½åä¸è§„èŒƒ (åº”ä¸º kebab-case): ${component.type}`);
                }
                
                // æ£€æŸ¥ç‰ˆæœ¬æ ¼å¼
                if (component.version && !/^\d+\.\d+\.\d+/.test(component.version)) {
                    issues.push(`ç»„ä»¶ç‰ˆæœ¬æ ¼å¼ä¸æ­£ç¡®: ${component.type} - ${component.version}`);
                }
            }
            
            return { valid: issues.length === 0, issues };
        }
        
        function showDebugInfo() {
            console.group('[Card2.1 ç»„ä»¶è°ƒè¯•ä¿¡æ¯]');
            console.log('ç»Ÿè®¡ä¿¡æ¯:', stats);
            console.log('æ‰€æœ‰åˆ†ç±»:', stats.categories);
            console.log('ç»„ä»¶è¯¦æƒ…:', components);
            console.table(components.map(c => ({
                ç±»å‹: c.type,
                åç§°: c.name,
                åˆ†ç±»: c.category,
                ç‰ˆæœ¬: c.version || 'æœªæŒ‡å®š',
                æ•°æ®æº: c.supportedDataSources?.join(', ') || 'æ— ',
                æ ‡ç­¾: c.tags?.join(', ') || 'æ— '
            })));
            console.groupEnd();
            
            alert('è°ƒè¯•ä¿¡æ¯å·²è¾“å‡ºåˆ°æ§åˆ¶å°ï¼Œè¯·æŒ‰ F12 æŸ¥çœ‹');
        }
        
        // å…¨å±€æš´éœ²å‡½æ•°
        window.runTest = runTest;
        window.showDebugInfo = showDebugInfo;
    </script>
</body>
</html>