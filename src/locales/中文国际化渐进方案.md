# ThingsPanel 中文国际化渐进方案

## 🎯 核心思想

**专注中文，分批处理，英文最后** - 避免一次性处理过多内容导致的复杂性和错误

## 📋 方案特点

- ✅ **只处理中文**: 暂时忽略英文翻译，专注中文文案国际化
- ✅ **分批处理**: 每次处理少量文件，确保质量和稳定性
- ✅ **智能生成**: 根据中文内容智能生成语义化的key
- ✅ **自动替换**: 脚本自动完成文案替换和导入添加
- ✅ **渐进式**: 可以随时停止，随时继续，不影响项目运行

## 🚀 三步工作流程

### 第一步：智能提取与键名生成
- 扫描指定的Vue/TS文件
- 提取所有中文文案
- 根据文案内容和上下文智能生成语义化key
- 生成中文JSON映射文件

### 第二步：自动替换
- 将中文文案替换为 `$t('key')` 调用
- 处理各种场景：模板、属性、对象等
- 确保语法正确，引号完整

### 第三步：导入添加
- 检测文件是否需要 `$t` 导入
- 自动添加 `import { $t } from '@/locales'`
- 处理Vue文件的setup函数

## 📁 文件组织

```
src/
├── locales/
│   ├── 中文国际化渐进方案.md     # 本方案文档
│   └── langs/
│       └── zh-CN/
│           ├── common.json      # 通用文案
│           ├── page.json        # 页面文案
│           └── index.ts         # 入口文件
scripts/
├── extract-chinese.mjs      # 提取中文文案脚本
├── generate-keys.mjs        # 生成键名脚本
└── replace-chinese.mjs      # 替换文案脚本
```

## 🔧 使用方式

### 批量处理模式
```bash
# 处理指定文件
node scripts/extract-chinese.mjs src/views/home/index.vue src/components/common/header.vue

# 处理整个目录
node scripts/extract-chinese.mjs src/views/user/
```

### 单文件处理模式
```bash
# 处理单个文件
node scripts/extract-chinese.mjs src/views/login/index.vue
```

## 📊 键名生成规则

### 通用文案 (common.json)
- 按钮: `common.button.{action}` (如: `common.button.save`)
- 状态: `common.status.{state}` (如: `common.status.loading`)
- 操作: `common.operation.{action}` (如: `common.operation.delete`)

### 页面文案 (page.json)
- 页面标题: `page.{module}.title`
- 页面内容: `page.{module}.{content}`
- 表单标签: `page.{module}.form.{field}`

### 智能识别
- 根据文案内容自动分类
- 根据文件路径确定模块
- 避免重复键名
- 生成语义化标识

## ✅ 优势

1. **风险可控**: 每次只处理少量文件，出错影响小
2. **质量保证**: 可以仔细检查每批处理结果
3. **灵活性强**: 可以根据实际情况调整策略
4. **易于维护**: 生成的key语义清晰，便于后续维护
5. **渐进式**: 不影响现有功能，可以逐步完善

## 🎯 执行计划

### 阶段一：核心组件 (第1-5批)
- 通用组件 (header, footer, menu等)
- 基础表单组件
- 常用按钮和操作

### 阶段二：主要页面 (第6-15批)
- 登录注册页面
- 用户管理页面
- 设备管理页面

### 阶段三：业务页面 (第16-30批)
- 数据分析页面
- 系统设置页面
- 其他业务页面

### 阶段四：英文翻译 (最后阶段)
- 基于完整的中文key结构
- 批量生成英文翻译
- 完善国际化架构

## 📝 注意事项

- 每次处理前先备份
- 处理后及时测试功能
- 发现问题立即停止并修复
- 保持键名的一致性和语义性 