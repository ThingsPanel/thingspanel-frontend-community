# Card 2.1 ç»„ä»¶è‡ªåŠ¨æ³¨å†Œç³»ç»Ÿä½¿ç”¨æŒ‡å—

## ğŸš€ æ¦‚è¿°

æ–°çš„è‡ªåŠ¨æ³¨å†Œç³»ç»Ÿè®©ä½ **æ— éœ€å†æ‰‹åŠ¨ç»´æŠ¤ç»„ä»¶åˆ—è¡¨**ï¼ç³»ç»Ÿä¼šè‡ªåŠ¨æ‰«æå¹¶æ³¨å†Œæ‰€æœ‰ç¬¦åˆè§„èŒƒçš„ç»„ä»¶ã€‚

## âœ¨ ä¸»è¦ä¼˜åŠ¿

- âœ… **é›¶ç»´æŠ¤**ï¼šæ–°å¢ç»„ä»¶æ— éœ€ä¿®æ”¹ `index.ts`
- âœ… **è‡ªåŠ¨å‘ç°**ï¼šæ”¯æŒä»»æ„æ·±åº¦çš„ç›®å½•ç»“æ„
- âœ… **å®æ—¶æ›´æ–°**ï¼šæ”¯æŒçƒ­é‡è½½å’ŒåŠ¨æ€åˆ·æ–°
- âœ… **ç±»å‹å®‰å…¨**ï¼šå®Œæ•´çš„ TypeScript æ”¯æŒ
- âœ… **å‘åå…¼å®¹**ï¼šç°æœ‰ä»£ç æ— éœ€ä¿®æ”¹

## ğŸ“ ç»„ä»¶å¼€å‘è§„èŒƒ

### 1. ç›®å½•ç»“æ„è§„èŒƒ

```
src/card2.1/components/
â”œâ”€â”€ åˆ†ç±»åç§°/
â”‚   â””â”€â”€ ç»„ä»¶åç§°/
â”‚       â”œâ”€â”€ index.ts          # ç»„ä»¶å®šä¹‰å¯¼å‡º (å¿…éœ€)
â”‚       â”œâ”€â”€ index.vue         # ç»„ä»¶å®ç°
â”‚       â”œâ”€â”€ setting.vue       # é…ç½®é¢æ¿ (å¯é€‰)
â”‚       â””â”€â”€ settingConfig.ts  # é…ç½®å®šä¹‰ (å¯é€‰)
â””â”€â”€ auto-registry.ts          # è‡ªåŠ¨æ³¨å†Œç³»ç»Ÿ (è¯·å‹¿ä¿®æ”¹)
```

### 2. ç»„ä»¶å®šä¹‰è§„èŒƒ

æ¯ä¸ªç»„ä»¶çš„ `index.ts` æ–‡ä»¶å¿…é¡»æŒ‰ä»¥ä¸‹æ–¹å¼å¯¼å‡ºï¼š

```typescript
// æ–¹å¼1ï¼šé»˜è®¤å¯¼å‡º (æ¨è)
export default {
  type: 'my-component',      // ç»„ä»¶å”¯ä¸€æ ‡è¯† (kebab-case)
  name: 'æˆ‘çš„ç»„ä»¶',           // æ˜¾ç¤ºåç§°
  category: 'æ•°æ®å±•ç¤º',      // ç»„ä»¶åˆ†ç±»
  component: MyComponent,    // Vue ç»„ä»¶
  // ... å…¶ä»–é…ç½®
} as ComponentDefinition

// æ–¹å¼2ï¼šå‘½åå¯¼å‡º
export const definition = { /* ... */ }
export const componentDefinition = { /* ... */ }
```

## ğŸ”§ ä½¿ç”¨æ–¹å¼

### æ–°å¢ç»„ä»¶çš„æ­¥éª¤

1. **åˆ›å»ºç»„ä»¶ç›®å½•**
```bash
mkdir -p src/card2.1/components/æ•°æ®å±•ç¤º/my-new-component
```

2. **åˆ›å»ºç»„ä»¶å®šä¹‰** (`index.ts`)
```typescript
import type { ComponentDefinition } from '../../../core/types'
import MyNewComponent from './index.vue'

export default {
  type: 'my-new-component',
  name: 'æˆ‘çš„æ–°ç»„ä»¶',
  category: 'æ•°æ®å±•ç¤º',
  version: '1.0.0',
  component: MyNewComponent,
  icon: 'chart-bar',
  description: 'å±•ç¤ºæ•°æ®çš„ç»„ä»¶',
  supportedDataSources: ['api', 'websocket'],
  tags: ['æ•°æ®', 'å›¾è¡¨'],
  config: {
    // ç»„ä»¶é…ç½®é¡¹
  }
} as ComponentDefinition
```

3. **åˆ›å»º Vue ç»„ä»¶** (`index.vue`)
```vue
<script setup lang="ts">
/**
 * æˆ‘çš„æ–°ç»„ä»¶
 * ç”¨äºå±•ç¤ºç‰¹å®šç±»å‹çš„æ•°æ®
 */
// ç»„ä»¶é€»è¾‘...
</script>

<template>
  <div class="my-new-component">
    <!-- ç»„ä»¶å†…å®¹ -->
  </div>
</template>
```

4. **å®Œæˆï¼** ğŸ‰
   - æ— éœ€ä¿®æ”¹ä»»ä½•å…¶ä»–æ–‡ä»¶
   - ç»„ä»¶ä¼šè‡ªåŠ¨å‡ºç°åœ¨ç¼–è¾‘å™¨ä¸­
   - æ”¯æŒçƒ­é‡è½½

## ğŸ“Š è°ƒè¯•å’ŒéªŒè¯

### å¼€å‘å·¥å…·å‡½æ•°

```typescript
import { debugComponents, validateComponents } from '@/card2.1/components'

// åœ¨æ§åˆ¶å°æŸ¥çœ‹æ‰€æœ‰ç»„ä»¶ä¿¡æ¯
debugComponents()

// éªŒè¯ç»„ä»¶å®šä¹‰æ˜¯å¦è§„èŒƒ
const validation = validateComponents()
if (!validation.valid) {
  console.log('å‘ç°é—®é¢˜:', validation.issues)
}
```

### åŠ¨æ€é‡æ–°åŠ è½½

```typescript
import { reloadComponents } from '@/card2.1/components'

// å¼€å‘æ—¶é‡æ–°æ‰«æç»„ä»¶ (é€šå¸¸ä¸éœ€è¦æ‰‹åŠ¨è°ƒç”¨)
await reloadComponents()
```

## ğŸ” å¸¸è§é—®é¢˜

### Q: ä¸ºä»€ä¹ˆæˆ‘çš„ç»„ä»¶æ²¡æœ‰è¢«è‡ªåŠ¨æ³¨å†Œï¼Ÿ

**A:** æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š
1. ç»„ä»¶ç›®å½•ä¸‹æ˜¯å¦æœ‰ `index.ts` æ–‡ä»¶
2. `index.ts` æ˜¯å¦æ­£ç¡®å¯¼å‡ºäº†ç»„ä»¶å®šä¹‰
3. ç»„ä»¶å®šä¹‰æ˜¯å¦åŒ…å«å¿…éœ€å­—æ®µ (`type`, `name`, `component`)
4. æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯ä¿¡æ¯

### Q: å¦‚ä½•æŸ¥çœ‹å½“å‰æ³¨å†Œäº†å“ªäº›ç»„ä»¶ï¼Ÿ

**A:** åœ¨æµè§ˆå™¨æ§åˆ¶å°è¿è¡Œï¼š
```javascript
import('@/card2.1/components').then(({ debugComponents }) => debugComponents())
```

### Q: ç»„ä»¶ç±»å‹å‘½åæœ‰ä»€ä¹ˆè¦æ±‚ï¼Ÿ

**A:** 
- å¿…é¡»ä½¿ç”¨ kebab-case æ ¼å¼ (ä¾‹å¦‚: `my-component`)
- åªèƒ½åŒ…å«å°å†™å­—æ¯ã€æ•°å­—å’Œè¿å­—ç¬¦
- åœ¨æ•´ä¸ªç³»ç»Ÿä¸­å¿…é¡»å”¯ä¸€

### Q: å¯ä»¥åµŒå¥—å¤šå±‚ç›®å½•å—ï¼Ÿ

**A:** å¯ä»¥ï¼ç³»ç»Ÿæ”¯æŒä»»æ„æ·±åº¦çš„ç›®å½•ç»“æ„ï¼š
```
components/
â”œâ”€â”€ åˆ†ç±»A/
â”‚   â”œâ”€â”€ å­åˆ†ç±»1/
â”‚   â”‚   â””â”€â”€ ç»„ä»¶A/index.ts    # âœ… æ”¯æŒ
â”‚   â””â”€â”€ ç»„ä»¶B/index.ts         # âœ… æ”¯æŒ
â””â”€â”€ åˆ†ç±»B/
    â””â”€â”€ ç»„ä»¶C/index.ts         # âœ… æ”¯æŒ
```

## ğŸ¯ æœ€ä½³å®è·µ

1. **ç»„ä»¶å‘½å**ï¼šä½¿ç”¨æ¸…æ™°ã€æè¿°æ€§çš„åç§°
2. **åˆ†ç±»ç»„ç»‡**ï¼šåˆç†ä½¿ç”¨åˆ†ç±»æ¥ç»„ç»‡ç›¸å…³ç»„ä»¶
3. **ç‰ˆæœ¬ç®¡ç†**ï¼šä¸ºç»„ä»¶æŒ‡å®šç‰ˆæœ¬å·ï¼Œä¾¿äºç»´æŠ¤
4. **æ–‡æ¡£å®Œå–„**ï¼šä¸ºç»„ä»¶æ·»åŠ è¯¦ç»†çš„æè¿°å’Œæ ‡ç­¾
5. **ç±»å‹å®‰å…¨**ï¼šä½¿ç”¨ TypeScript ç±»å‹å®šä¹‰
6. **æµ‹è¯•éªŒè¯**ï¼šå®šæœŸè¿è¡Œ `validateComponents()` æ£€æŸ¥è§„èŒƒæ€§

## ğŸ”„ è¿ç§»ç°æœ‰ç»„ä»¶

å¦‚æœä½ æœ‰ç°æœ‰çš„ç»„ä»¶éœ€è¦è¿ç§»åˆ°æ–°ç³»ç»Ÿï¼š

1. ç¡®ä¿ç»„ä»¶å®šä¹‰ç¬¦åˆä¸Šè¿°è§„èŒƒ
2. ç¡®ä¿ `index.ts` æ­£ç¡®å¯¼å‡ºå®šä¹‰
3. åˆ é™¤åŸæ¥åœ¨ `components/index.ts` ä¸­çš„æ‰‹åŠ¨æ³¨å†Œä»£ç 
4. ç³»ç»Ÿä¼šè‡ªåŠ¨è¯†åˆ«å¹¶æ³¨å†Œç»„ä»¶

## ğŸ› ï¸ é«˜çº§ç”¨æ³•

### æ¡ä»¶æ€§æ³¨å†Œ

å¦‚æœéœ€è¦æ ¹æ®ç¯å¢ƒæ¡ä»¶æ³¨å†Œç»„ä»¶ï¼š

```typescript
// åœ¨ç»„ä»¶å®šä¹‰ä¸­
export default {
  type: 'dev-only-component',
  name: 'å¼€å‘ä¸“ç”¨ç»„ä»¶',
  // åªåœ¨å¼€å‘ç¯å¢ƒä¸­å¯ç”¨
  enabled: import.meta.env.DEV,
  // ... å…¶ä»–é…ç½®
} as ComponentDefinition
```

### åŠ¨æ€é…ç½®

ç»„ä»¶å¯ä»¥æ ¹æ®è¿è¡Œæ—¶æ¡ä»¶åŠ¨æ€é…ç½®ï¼š

```typescript
const isDarkMode = useThemeStore().darkMode

export default {
  type: 'theme-aware-component',
  name: 'ä¸»é¢˜æ„ŸçŸ¥ç»„ä»¶',
  icon: isDarkMode ? 'moon' : 'sun',
  // ... å…¶ä»–é…ç½®
} as ComponentDefinition
```

---

é€šè¿‡è¿™å¥—è‡ªåŠ¨æ³¨å†Œç³»ç»Ÿï¼Œç»„ä»¶å¼€å‘å˜å¾—æ›´åŠ ç®€å•é«˜æ•ˆï¼ğŸš€