# Card 2.1 ç¼–è¾‘å™¨é›†æˆæŒ‡å—

## æ¦‚è¿°

æœ¬æ¨¡å—æä¾› Card 2.1 ç»„ä»¶ä¸ Visual Editor çš„æ ‡å‡†é›†æˆæ¥å£ï¼Œç¡®ä¿ç»„ä»¶èƒ½å¤Ÿé¡ºåˆ©é›†æˆåˆ°å„ç§æ¸²æŸ“å™¨ä¸­ã€‚

## å·²å‡†å¤‡çš„ç»„ä»¶

### 1. ç®€å•æµ‹è¯•ç»„ä»¶ (`simple-test-component`)
- **ç”¨é€”**: ç”¨äºæµ‹è¯•ç»„ä»¶é…ç½®ã€äº¤äº’å’Œå±æ€§æš´éœ²çš„åŸºç¡€ç»„ä»¶
- **ç‰¹æ€§**: æ”¯æŒå±æ€§å˜åŒ–æµ‹è¯•ã€äº¤äº’çŠ¶æ€å±•ç¤ºã€æ•°æ®æ¨¡æ‹Ÿ
- **æ•°æ®æºæ”¯æŒ**: é™æ€æ•°æ®ã€APIã€WebSocket
- **é»˜è®¤å°ºå¯¸**: 300x200px

### 2. æ•°æ®å±•ç¤ºå¡ç‰‡ (`data-display-card`) 
- **ç”¨é€”**: åŠŸèƒ½ä¸°å¯Œçš„æ•°æ®å±•ç¤ºå¡ç‰‡ï¼Œæ”¯æŒæŒ‡æ ‡å±•ç¤ºã€è¶‹åŠ¿åˆ†æå’Œæ•°æ®åˆ—è¡¨
- **ç‰¹æ€§**: å®æ—¶æ•°æ®æ›´æ–°ã€è¶‹åŠ¿æŒ‡ç¤ºã€å¤šæŒ‡æ ‡å±•ç¤º
- **æ•°æ®æºæ”¯æŒ**: é™æ€æ•°æ®ã€APIã€WebSocketã€MQTT
- **é»˜è®¤å°ºå¯¸**: 320x240px

## é›†æˆé…ç½®

### ä¸»è¦æ–‡ä»¶ç»“æ„

```
src/card2.1/integration/
â”œâ”€â”€ visual-editor-config.ts    # ç¼–è¾‘å™¨é›†æˆä¸»é…ç½®
â”œâ”€â”€ README.md                  # æœ¬è¯´æ˜æ–‡æ¡£
```

```
src/card2.1/components/
â”œâ”€â”€ index.ts                   # ç»„ä»¶ç»Ÿä¸€å¯¼å‡º
â”œâ”€â”€ simple-test-component/
â”‚   â””â”€â”€ index.ts              # ç»„ä»¶å®šä¹‰ï¼ˆå«ç¼–è¾‘å™¨é…ç½®ï¼‰
â””â”€â”€ data-display-card/
    â””â”€â”€ index.ts              # ç»„ä»¶å®šä¹‰ï¼ˆå«ç¼–è¾‘å™¨é…ç½®ï¼‰
```

### æ ¸å¿ƒé…ç½®ç‰¹æ€§

#### 1. ç¼–è¾‘å™¨å…¼å®¹æ€§é…ç½®
- âœ… **ç»„ä»¶å°ºå¯¸è§„èŒƒ**: åŒ…å« `defaultSize` å’Œ `minSize` é…ç½®
- âœ… **ç¤ºä¾‹é…ç½®**: æä¾›å¤šä¸ªé¢„è®¾ç¤ºä¾‹ä¾›ç¼–è¾‘å™¨é¢„è§ˆ
- âœ… **å±æ€§å®šä¹‰**: è¯¦ç»†çš„å±æ€§ç±»å‹å’Œé€‰é¡¹é…ç½®
- âœ… **å¸ƒå±€é€‚é…**: æ”¯æŒ Canvasã€Gridstack ç­‰å¤šç§æ¸²æŸ“å™¨

#### 2. æ•°æ®æºé›†æˆ
- âœ… **æ•°æ®æºå£°æ˜**: `supportedDataSources` æ˜ç¡®æ”¯æŒçš„æ•°æ®æºç±»å‹
- âœ… **å±æ€§æš´éœ²**: å®Œæ•´çš„å±æ€§æš´éœ²é…ç½®ï¼Œæ”¯æŒåŠ¨æ€å±æ€§ç›‘å¬
- âœ… **æ•°æ®æ¨¡æ‹Ÿ**: å†…ç½®æ•°æ®æ¨¡æ‹Ÿå™¨ï¼Œæ”¯æŒå®æ—¶æ•°æ®æ¼”ç¤º

#### 3. äº¤äº’èƒ½åŠ›
- âœ… **äº‹ä»¶å¤„ç†**: æ ‡å‡†åŒ–çš„äº¤äº’äº‹ä»¶ç³»ç»Ÿ
- âœ… **å±æ€§å˜åŒ–**: æ”¯æŒè¿è¡Œæ—¶å±æ€§ä¿®æ”¹å’Œäº‹ä»¶è§¦å‘
- âœ… **è°ƒè¯•æ”¯æŒ**: å†…ç½®è°ƒè¯•æŒ‡ç¤ºå™¨å’ŒçŠ¶æ€å±•ç¤º

## ä½¿ç”¨æ–¹å¼

### 1. å¯¼å…¥ç»„ä»¶é…ç½®

```typescript
import { VisualEditorIntegrationConfig } from '@/card2.1/integration/visual-editor-config'

// è·å–æ‰€æœ‰å¯ç”¨ç»„ä»¶
const widgets = VisualEditorIntegrationConfig.widgets

// æŒ‰åˆ†ç±»è·å–ç»„ä»¶
const displayWidgets = VisualEditorIntegrationConfig.categories['å±•ç¤º']
```

### 2. åœ¨ç¼–è¾‘å™¨ä¸­æ³¨å†Œç»„ä»¶

```typescript
import { getCard2Widget, isCard2Component } from '@/card2.1/integration/visual-editor-config'

// æ£€æŸ¥å¹¶è·å–ç»„ä»¶é…ç½®
if (isCard2Component('data-display-card')) {
  const widget = getCard2Widget('data-display-card')
  // æ³¨å†Œåˆ°ç¼–è¾‘å™¨...
}
```

### 3. ç»„ä»¶å®ä¾‹åŒ–

```vue
<script setup>
import { getCard2Definition } from '@/card2.1/integration/visual-editor-config'

// è·å–ç»„ä»¶å®šä¹‰
const definition = getCard2Definition('simple-test-component')

// ä½¿ç”¨ç»„ä»¶
const ComponentClass = definition.component
</script>

<template>
  <ComponentClass
    :config="componentConfig"
    :component-id="uniqueId"
    :show-interaction-indicator="true"
  />
</template>
```

## ç¼–è¾‘å™¨é›†æˆæ£€æŸ¥æ¸…å•

### âœ… å·²å®Œæˆçš„å‡†å¤‡å·¥ä½œ

- [x] **ç»„ä»¶å®šä¹‰å®Œå–„**: ä¸¤ä¸ªç»„ä»¶çš„ `index.ts` éƒ½åŒ…å«å®Œæ•´çš„ç¼–è¾‘å™¨é›†æˆé…ç½®
- [x] **å°ºå¯¸è§„èŒƒ**: è®¾ç½®äº† `defaultSize` å’Œ `minSize` 
- [x] **ç¤ºä¾‹é…ç½®**: æ¯ä¸ªç»„ä»¶æä¾› 2-3 ä¸ªå…¸å‹ä½¿ç”¨ç¤ºä¾‹
- [x] **å±æ€§å®šä¹‰**: è¯¦ç»†çš„ `properties` é…ç½®ï¼ŒåŒ…å«ç±»å‹ã€é€‰é¡¹ã€éªŒè¯
- [x] **æ•°æ®æºæ”¯æŒ**: æ˜ç¡®å£°æ˜ `supportedDataSources`
- [x] **å±æ€§æš´éœ²ç³»ç»Ÿ**: å®Œæ•´çš„å±æ€§æš´éœ²é…ç½®ï¼Œæ”¯æŒåŠ¨æ€ç›‘å¬
- [x] **è½¬æ¢å™¨å‡½æ•°**: `convertToCard2Widget` å°† Card2.1 å®šä¹‰è½¬æ¢ä¸ºç¼–è¾‘å™¨æ ¼å¼
- [x] **å·¥å…·å‡½æ•°é›†**: æä¾›å®Œæ•´çš„æŸ¥è¯¢å’Œç­›é€‰å·¥å…·å‡½æ•°
- [x] **ç»Ÿä¸€å¯¼å‡º**: ä¸­å¤®åŒ–çš„ç»„ä»¶å¯¼å‡ºå’Œç®¡ç†

### ğŸ”„ å¾…ç¼–è¾‘å™¨ç«¯å®Œæˆçš„å·¥ä½œ

- [ ] **ç»„ä»¶æ³¨å†Œ**: å°† Card 2.1 ç»„ä»¶æ³¨å†Œåˆ° Visual Editor ç»„ä»¶åº“
- [ ] **æ¸²æŸ“å™¨é€‚é…**: ç¡®ä¿ç»„ä»¶åœ¨å„ç§æ¸²æŸ“å™¨ä¸­æ­£å¸¸å·¥ä½œ
- [ ] **å±æ€§ç¼–è¾‘é¢æ¿**: åŸºäº `properties` é…ç½®ç”Ÿæˆå±æ€§ç¼–è¾‘ç•Œé¢
- [ ] **æ•°æ®ç»‘å®š**: é›†æˆæ•°æ®æºç³»ç»Ÿï¼Œæ”¯æŒåŠ¨æ€æ•°æ®ç»‘å®š
- [ ] **é¢„è§ˆåŠŸèƒ½**: åœ¨ç¼–è¾‘å™¨ä¸­æ­£ç¡®é¢„è§ˆå’Œæ“ä½œç»„ä»¶

## æµ‹è¯•éªŒè¯

### å¯ç”¨çš„æµ‹è¯•é¡µé¢

1. **Visual Editor é›†æˆæµ‹è¯•**: `/test/editor-integration`
   - æµ‹è¯•ç»„ä»¶åœ¨ç¼–è¾‘å™¨ä¸­çš„è¡¨ç°
   - éªŒè¯æ‹–æ‹½ã€è°ƒæ•´å¤§å°ç­‰åŸºæœ¬æ“ä½œ

2. **Card 2.1 æ•°æ®ç»‘å®šæµ‹è¯•**: `/test/data-binding-system-integration`
   - æµ‹è¯•å®Œæ•´çš„æ•°æ®ç»‘å®šæµç¨‹
   - éªŒè¯å±æ€§æš´éœ²å’Œäº¤äº’ç³»ç»Ÿ

### é›†æˆéªŒè¯æ­¥éª¤

```bash
# 1. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
pnpm dev

# 2. è®¿é—®æµ‹è¯•é¡µé¢
http://localhost:5002/test/editor-integration

# 3. éªŒè¯åŠŸèƒ½
- ç»„ä»¶èƒ½å¦æ­£å¸¸åŠ è½½
- å±æ€§é…ç½®æ˜¯å¦ç”Ÿæ•ˆ
- äº¤äº’åŠŸèƒ½æ˜¯å¦æ­£å¸¸
- æ•°æ®ç»‘å®šæ˜¯å¦å·¥ä½œ
```

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **ç»„ä»¶æœªæ˜¾ç¤ºåœ¨ç¼–è¾‘å™¨ä¸­**
   - æ£€æŸ¥ `isRegistered: true` æ˜¯å¦è®¾ç½®
   - éªŒè¯ç»„ä»¶å¯¼å‡ºæ˜¯å¦æ­£ç¡®

2. **å¸ƒå±€å°ºå¯¸ä¸æ­£ç¡®**
   - æ£€æŸ¥ `defaultLayout` é…ç½®
   - éªŒè¯ `defaultSize` å’Œ `minSize` è®¾ç½®

3. **å±æ€§ç¼–è¾‘é¢æ¿ç©ºç™½**
   - ç¡®è®¤ `properties` é…ç½®å®Œæ•´
   - æ£€æŸ¥å±æ€§ç±»å‹å®šä¹‰æ˜¯å¦æ­£ç¡®

4. **æ•°æ®ç»‘å®šä¸å·¥ä½œ**
   - éªŒè¯ `supportedDataSources` è®¾ç½®
   - æ£€æŸ¥å±æ€§æš´éœ²æ³¨å†Œæ˜¯å¦å®Œæˆ

## ç‰ˆæœ¬ä¿¡æ¯

- **Card 2.1 ç‰ˆæœ¬**: 2.1.0
- **é›†æˆé…ç½®ç‰ˆæœ¬**: 1.0.0
- **å…¼å®¹çš„ç¼–è¾‘å™¨ç‰ˆæœ¬**: >= 1.0.0

---

## è”ç³»æ–¹å¼

å¦‚é‡åˆ°é›†æˆé—®é¢˜ï¼Œè¯·ï¼š
1. æŸ¥çœ‹æœ¬æ–‡æ¡£çš„æ•…éšœæ’é™¤éƒ¨åˆ†
2. è®¿é—®æµ‹è¯•é¡µé¢éªŒè¯åŠŸèƒ½
3. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°çš„é”™è¯¯ä¿¡æ¯
4. è”ç³»å¼€å‘å›¢é˜Ÿè¿›è¡Œæ”¯æŒ