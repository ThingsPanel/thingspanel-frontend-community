<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å†…éƒ¨èœå•æ•°æ®æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            line-height: 1.6;
        }
        .test-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        .json-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 16px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            overflow-x: auto;
            margin: 16px 0;
        }
        .result-block {
            background: #e7f3ff;
            padding: 16px;
            border-radius: 8px;
            margin: 16px 0;
        }
        .menu-item {
            padding: 8px;
            border-bottom: 1px solid #ddd;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <h1>ğŸ” å†…éƒ¨èœå•æ•°æ®å¤„ç†æµ‹è¯•</h1>
    
    <div class="test-section">
        <h3>åŸå§‹APIæ•°æ®ï¼ˆä½ æä¾›çš„ï¼‰ï¼š</h3>
        <div class="json-block" id="original-data"></div>
    </div>

    <div class="test-section">
        <h3>flattenRoutes å‡½æ•°å¤„ç†ç»“æœï¼š</h3>
        <div class="result-block" id="flattened-result"></div>
    </div>

    <div class="test-section">
        <h3>é¢„æœŸçš„ä¸‹æ‹‰é€‰é¡¹æ ¼å¼ï¼š</h3>
        <div class="result-block" id="dropdown-options"></div>
    </div>

    <script>
        // ä½ æä¾›çš„åŸå§‹æ•°æ®
        const originalData = {
            "code": 200,
            "message": "æ“ä½œæˆåŠŸ",
            "data": {
                "list": [
                    {
                        "id": "a190f7a5-1501-3814-9dd1-f3e1fbe7265e",
                        "parent_id": "0",
                        "element_code": "home",
                        "element_type": 3,
                        "orders": 0,
                        "param1": "/home",
                        "param2": "mdi:alpha-f-box-outline",
                        "param3": "self",
                        "authority": "[\"SYS_ADMIN\",\"TENANT_ADMIN\"]",
                        "description": "é¦–é¡µ",
                        "remark": "home",
                        "multilingual": "route.home",
                        "route_path": "layout.base$view.home",
                        "children": []
                    },
                    {
                        "id": "5373a6a2-1861-af35-eb4c-adfd5ca55ecd",
                        "parent_id": "0",
                        "element_code": "device",
                        "element_type": 1,
                        "orders": 112,
                        "param1": "/device",
                        "param2": "icon-park-outline:workbench",
                        "param3": "0",
                        "authority": "[\"TENANT_ADMIN\"]",
                        "description": "è®¾å¤‡æ¥å…¥",
                        "remark": "",
                        "multilingual": "route.device",
                        "route_path": "layout.base",
                        "children": [
                            {
                                "id": "c4dff952-3bf4-8102-6882-e9d3f3cffbda",
                                "parent_id": "5373a6a2-1861-af35-eb4c-adfd5ca55ecd",
                                "element_code": "device_manage",
                                "element_type": 3,
                                "orders": 1121,
                                "param1": "/device/manage",
                                "param2": "icon-park-outline:analysis",
                                "param3": "0",
                                "authority": "[\"TENANT_ADMIN\",\"SYS_ADMIN\"]",
                                "description": "è®¾å¤‡ç®¡ç†",
                                "remark": "",
                                "multilingual": "route.device_manage",
                                "route_path": "view.device_manage",
                                "children": []
                            },
                            {
                                "id": "75785418-a5af-d790-0783-e4ee4e42521e",
                                "parent_id": "5373a6a2-1861-af35-eb4c-adfd5ca55ecd",
                                "element_code": "device_grouping",
                                "element_type": 3,
                                "orders": 1122,
                                "param1": "/device/grouping",
                                "param2": "material-symbols:grid-on-outline-sharp",
                                "param3": "0",
                                "authority": "[\"TENANT_ADMIN\",\"SYS_ADMIN\"]",
                                "description": "è®¾å¤‡åˆ†ç»„",
                                "remark": "",
                                "multilingual": "route.device_grouping",
                                "route_path": "view.device_grouping",
                                "children": []
                            }
                        ]
                    },
                    {
                        "id": "95e2a961-382b-f4a6-87b3-1898123c95bc",
                        "parent_id": "0",
                        "element_code": "visualization",
                        "element_type": 1,
                        "orders": 113,
                        "param1": "/visualization",
                        "param2": "icon-park-outline:data-server",
                        "param3": "self",
                        "authority": "[\"TENANT_ADMIN\",\"SYS_ADMIN\"]",
                        "description": "å¯è§†åŒ–",
                        "remark": "",
                        "multilingual": "route.visualization",
                        "route_path": "layout.base",
                        "children": [
                            {
                                "id": "a2654c98-3749-c88b-0472-b414049ca532",
                                "parent_id": "95e2a961-382b-f4a6-87b3-1898123c95bc",
                                "element_code": "route.visualization_kanban",
                                "element_type": 3,
                                "orders": 1131,
                                "param1": "/visualization/kanban",
                                "param2": "tabler:device-tv",
                                "param3": "self",
                                "authority": "[\"TENANT_ADMIN\",\"SYS_ADMIN\"]",
                                "description": "çœ‹æ¿",
                                "remark": "",
                                "multilingual": "route.visualization_kanban",
                                "route_path": "view.visualization_panel",
                                "children": []
                            }
                        ]
                    }
                ]
            }
        };

        // å¤åˆ¶ä½ çš„ flattenRoutes å‡½æ•°
        function flattenRoutes(routes, prefix = '') {
            const options = [];
            
            for (const route of routes) {
                // ä½¿ç”¨ param1 ä½œä¸ºè·¯å¾„ï¼Œdescription ä½œä¸ºæ ‡ç­¾
                const path = route.param1;
                const title = route.description || route.multilingual || route.element_code;
                const fullLabel = prefix ? `${prefix} / ${title}` : title;
                
                if (path && title) {
                    options.push({
                        label: fullLabel,
                        value: path
                    });
                }
                
                // é€’å½’å¤„ç†å­è·¯ç”±
                if (route.children && route.children.length > 0) {
                    options.push(...flattenRoutes(route.children, fullLabel));
                }
            }
            
            return options;
        }

        // æµ‹è¯•å‡½æ•°
        function runTest() {
            console.log('ğŸ” å¼€å§‹æµ‹è¯•èœå•æ•°æ®å¤„ç†...');
            
            // æ˜¾ç¤ºåŸå§‹æ•°æ®
            document.getElementById('original-data').textContent = JSON.stringify(originalData, null, 2);
            
            // å¤„ç†æ•°æ®
            const routes = originalData.data.list;
            const flattened = flattenRoutes(routes);
            
            console.log('ğŸ“Š å¤„ç†ç»“æœ:', flattened);
            
            // æ˜¾ç¤ºå¤„ç†ç»“æœ
            let resultHtml = '<h4>å¤„ç†ç»“æœ (' + flattened.length + ' é¡¹):</h4>';
            flattened.forEach((item, index) => {
                resultHtml += `<div class="menu-item">${index + 1}. label: "${item.label}" â†’ value: "${item.value}"</div>`;
            });
            
            document.getElementById('flattened-result').innerHTML = resultHtml;
            
            // æ˜¾ç¤ºä¸‹æ‹‰é€‰é¡¹æ ¼å¼
            let dropdownHtml = '<h4>Naive UI ä¸‹æ‹‰é€‰é¡¹:</h4>';
            dropdownHtml += '<div class="json-block">' + JSON.stringify(flattened, null, 2) + '</div>';
            
            document.getElementById('dropdown-options').innerHTML = dropdownHtml;
            
            // æ£€æŸ¥æ˜¯å¦æœ‰æ•°æ®
            if (flattened.length === 0) {
                alert('âŒ å¤„ç†ç»“æœä¸ºç©ºï¼è¯·æ£€æŸ¥æ•°æ®ç»“æ„');
            } else {
                alert('âœ… å¤„ç†æˆåŠŸï¼ç”Ÿæˆäº† ' + flattened.length + ' ä¸ªèœå•é€‰é¡¹');
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆåè¿è¡Œæµ‹è¯•
        document.addEventListener('DOMContentLoaded', runTest);
    </script>
</body>
</html>